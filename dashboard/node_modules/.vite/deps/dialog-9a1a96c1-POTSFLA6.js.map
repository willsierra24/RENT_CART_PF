{
  "version": 3,
  "sources": ["../../@uploadcare/react-widget/dist/esm/dialog-9a1a96c1.mjs"],
  "sourcesContent": ["import { b as _slicedToArray, _ as _objectWithoutProperties, a as _objectSpread2, c as _toConsumableArray, d as _createForOfIteratorHelper } from './index-af0ad5a4.mjs';\nimport React, { useState, useMemo, useRef, useEffect, useImperativeHandle } from 'react';\nimport uploadcare from 'uploadcare-widget';\nimport { u as useCommitedCallback, a as useCustomTabs, b as useDeepEffect, d as defaultPreviewUrlCallback } from './default-preview-url-callback-99f7fcfa.mjs';\nimport 'react-fast-compare';\nimport '@uploadcare/client-suspense';\n\nvar _excluded = [\"value\", \"apiRef\", \"onTabChange\", \"onChange\", \"onProgress\", \"customTabs\", \"previewUrlCallback\", \"metadataCallback\"];\nvar containerStyles = {\n  height: '500px',\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'center',\n  justifyContent: 'center'\n};\n\nvar getHiddenDoneButtonStyle = function getHiddenDoneButtonStyle(containerId) {\n  return (\n    /* css */\n    \"\\n  .\".concat(containerId, \" .uploadcare--preview__done:not(.uploadcare-tab-effects--done),\\n  .\").concat(containerId, \" .uploadcare--panel__done:not(.uploadcare-tab-effects--done) {\\n    display: none;\\n  }\\n\")\n  );\n};\n\nvar getValueItems = function getValueItems(value, props) {\n  var uuids = [];\n\n  if (value) {\n    uuids = Array.isArray(value) ? value : [value];\n  }\n\n  return uuids;\n};\n\nvar useDialog = function useDialog(props, uploadcare) {\n  var value = props.value,\n      apiRef = props.apiRef,\n      onTabChange = props.onTabChange,\n      onChange = props.onChange,\n      onProgress = props.onProgress,\n      customTabs = props.customTabs,\n      previewUrlCallback = props.previewUrlCallback,\n      metadataCallback = props.metadataCallback,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  var tabsCss = restProps.tabsCss,\n      locale = restProps.locale,\n      localeTranslations = restProps.localeTranslations,\n      localePluralize = restProps.localePluralize;\n  var panelContainer = useRef(null);\n  var panelInstance = useRef(null);\n  var onTabChangeCallback = useCommitedCallback(onTabChange);\n  var onChangeCallback = useCommitedCallback(onChange);\n  var onProgressCallback = useCommitedCallback(onProgress);\n  var metadataCommitedCallback = useCommitedCallback(metadataCallback);\n  var previewUrlCommitedCallback = useCommitedCallback(previewUrlCallback || defaultPreviewUrlCallback);\n  useCustomTabs(customTabs, uploadcare);\n  useDeepEffect(function () {\n    if (locale) window.UPLOADCARE_LOCALE = locale;\n    if (localePluralize) window.UPLOADCARE_LOCALE_PLURALIZE = localePluralize;\n\n    if (localeTranslations) {\n      window.UPLOADCARE_LOCALE_TRANSLATIONS = localeTranslations;\n    }\n\n    return function () {\n      if (locale) delete window.UPLOADCARE_LOCALE;\n      if (localePluralize) delete window.UPLOADCARE_LOCALE_PLURALIZE;\n      if (localeTranslations) delete window.UPLOADCARE_LOCALE_TRANSLATIONS;\n    };\n  }, [locale, localePluralize, localeTranslations]);\n  useEffect(function () {\n    if (uploadcare && tabsCss && typeof tabsCss === 'string') {\n      if (tabsCss.indexOf('https://') === 0) {\n        uploadcare.tabsCss.addUrl(tabsCss);\n      } else {\n        uploadcare.tabsCss.addStyle(tabsCss);\n      }\n    }\n  }, [uploadcare, tabsCss]);\n  useEffect(function () {\n    var files = getValueItems(value);\n    panelInstance.current && panelInstance.current.reject();\n    panelInstance.current = uploadcare.openPanel(panelContainer.current, files, _objectSpread2(_objectSpread2({\n      multipleMax: restProps.multiple ? undefined : 1\n    }, restProps), {}, {\n      multiple: true,\n      metadataCallback: restProps.metadata ? undefined : metadataCommitedCallback,\n      previewUrlCallback: previewUrlCommitedCallback\n    })); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [uploadcare].concat(_toConsumableArray(Object.values(restProps))));\n  useEffect(function () {\n    var dialogApi = panelInstance.current;\n    dialogApi.progress(onTabChangeCallback);\n\n    var onChangeWrapper = function onChangeWrapper() {\n      var items = panelInstance.current.fileColl.__items.map(function (deferred) {\n        return deferred.promise();\n      });\n\n      onChangeCallback(items);\n    };\n\n    var onProgressWrapper = function onProgressWrapper() {\n      var lastProgresses = panelInstance.current.fileColl.lastProgresses();\n      onProgressCallback(lastProgresses);\n    };\n\n    dialogApi.fileColl.anyProgressList.add(onProgressWrapper);\n    dialogApi.fileColl.anyDoneList.add(onChangeWrapper);\n    dialogApi.fileColl.anyFailList.add(onChangeWrapper);\n    dialogApi.fileColl.onRemove.add(onChangeWrapper);\n    dialogApi.fileColl.onReplace.add(onChangeWrapper);\n    dialogApi.fileColl.onSort.add(onChangeWrapper);\n    return function () {\n      var dialogApi = panelInstance.current;\n      dialogApi.fileColl.anyProgressList.remove(onProgressWrapper);\n      dialogApi.fileColl.anyDoneList.remove(onChangeWrapper);\n      dialogApi.fileColl.anyFailList.remove(onChangeWrapper);\n      dialogApi.fileColl.onRemove.remove(onChangeWrapper);\n      dialogApi.fileColl.onReplace.remove(onChangeWrapper);\n      dialogApi.fileColl.onSort.remove(onChangeWrapper);\n    };\n  }, [].concat(_toConsumableArray(Object.values(restProps)), [onTabChangeCallback, onChangeCallback, onProgressCallback]));\n  useImperativeHandle(apiRef, function () {\n    return {\n      onTabVisibility: function onTabVisibility(cb) {\n        return panelInstance.current.onTabVisibility(cb);\n      },\n      hideTab: function hideTab(tab) {\n        return panelInstance.current.hideTab(tab);\n      },\n      showTab: function showTab(tab) {\n        return panelInstance.current.showTab(tab);\n      },\n      switchTab: function switchTab(tab) {\n        return panelInstance.current.switchTab(tab);\n      },\n      addFiles: function addFiles(files) {\n        return panelInstance.current.addFiles(files);\n      },\n      isTabVisible: function isTabVisible(tab) {\n        return panelInstance.current.isTabVisible(tab);\n      },\n      getFileColl: function getFileColl() {\n        return panelInstance.current.fileColl;\n      },\n      getRawDialogApi: function getRawDialogApi() {\n        return panelInstance.current;\n      }\n    };\n  }, []);\n  useEffect(function () {\n    return function () {\n      return panelInstance.current && panelInstance.current.reject();\n    };\n  }, []);\n  useEffect(function () {\n    var isUpdated = false;\n    panelInstance.current.fileColl.clear();\n    var files = getValueItems(value);\n\n    var _iterator = _createForOfIteratorHelper(files),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var item = _step.value;\n\n        if (typeof item === 'string' && item.includes('~')) {\n          uploadcare.loadFileGroup(item, props).then(function (fileGroup) {\n            // value could be changed after group loaded\n            if (!isUpdated) {\n              var _files = fileGroup.files();\n\n              panelInstance.current.addFiles(_files);\n            }\n          });\n          break;\n        }\n\n        panelInstance.current.fileColl.add(uploadcare.fileFrom('uploaded', item, props));\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    return function () {\n      isUpdated = true;\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n  return [panelContainer];\n};\n\nvar Dialog = function Dialog(props) {\n  var _useState = useState(function () {\n    return \"uploadcare-\".concat(Date.now());\n  }),\n      _useState2 = _slicedToArray(_useState, 1),\n      containerId = _useState2[0];\n\n  var styleElement = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"style\", null, getHiddenDoneButtonStyle(containerId));\n  }, [containerId]);\n\n  var _useDialog = useDialog(props, uploadcare),\n      _useDialog2 = _slicedToArray(_useDialog, 1),\n      containerRef = _useDialog2[0];\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: props.id,\n    className: containerId,\n    style: containerStyles\n  }, styleElement, /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef\n  }));\n};\n\nexport { Dialog as default };\n"],
  "mappings": "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",
  "names": ["getHiddenDoneButtonStyle", "getValueItems", "useDialog", "uploadcare", "onChangeWrapper", "onProgressWrapper", "dialogApi", "Dialog", "React"]
}
